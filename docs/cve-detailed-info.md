# CVE Detailed Information & Search Documentation

SOFA provides comprehensive CVE (Common Vulnerabilities and Exposures) tracking and detailed information across all Apple platforms. The system includes both search capabilities and detailed CVE pages with enriched data from multiple sources.

## CVE System Overview

The CVE system consists of two main components:
1. **CVE Search** (`/cve-search`) - Search and discover CVEs across all platforms
2. **CVE Details** (`/cve-details?cveId=CVE-XXXX-XXXX`) - Detailed information for specific CVEs

## CVE Search Functionality

### **Access & URL**
- **URL**: `/cve-search`
- **Component**: `CveSearch.vue`
- **Navigation**: Available in Tools section of sidebar

### **Search Features**
- **Real-time Search**: Search as you type functionality
- **Pattern Matching**: Supports partial CVE IDs (e.g., "CVE-2024", "2024-1234")
- **Multi-Platform Coverage**: Searches across macOS, iOS, tvOS, watchOS, visionOS
- **KEV Prioritization**: "KEV on Top" option to prioritize actively exploited vulnerabilities
- **CSV Export**: Export search results for analysis and reporting

### **Search Results Display**
Each search result shows:
- **CVE ID**: Clickable link to detailed CVE page
- **KEV Badge**: Red indicator for Known Exploited Vulnerabilities
- **OS Versions**: Affected Apple OS versions with fixes
- **Apple Security Notes**: Links to official Apple security documentation
- **External Resources**: Quick links to CVE.org, NVD, CISA KEV, CVEfeed, OpenCVE

### **Data Sources**
Search queries all V2 data feeds:
- `/v2/macos_data_feed.json`
- `/v2/ios_data_feed.json`
- `/v2/tvos_data_feed.json`
- `/v2/watchos_data_feed.json`
- `/v2/visionos_data_feed.json`

## CVE Details Pages

### **Access & URL Pattern**
- **URL**: `/cve-details?cveId=CVE-XXXX-XXXX`
- **Component**: `CveDetails.vue`
- **Navigation**: Accessed via search results or direct URL with query parameter

### **Query Parameter Handling**
The system handles CVE ID extraction from:
- URL query parameters: `?cveId=CVE-2024-1234`
- VitePress route query: `route.query.cveId`
- Browser URL parameters: `URLSearchParams`

### **Data Enrichment Sources**

#### **1. Apple CVE Context Database**
- **File**: `/resources/apple_cves_with_context.ndjson`
- **Format**: NDJSON (Newline Delimited JSON)
- **Content**: 3,000+ CVEs with Apple-specific context
- **Structure**:
```json
{
  "cve_id": "CVE-XXXX-XXXX",
  "platforms_with_fix": ["iOS", "macOS", "Safari"],
  "os_versions_with_fix": ["iOS 18.1", "macOS 15.1"],
  "first_fix_date": "2024-10-28",
  "last_fix_date": "2024-10-28",
  "apple_security_index_urls": ["https://support.apple.com/..."],
  "apple_security_bulletin_urls": ["https://support.apple.com/..."],
  "is_actively_exploited": false,
  "is_in_kev_catalog": false,
  "tags": ["platform:ios", "platform:macos", "webkit"]
}
```

#### **2. CISA KEV Catalog**
- **File**: `/resources/kev_catalog.json`
- **Content**: Known Exploited Vulnerabilities catalog
- **Structure**:
```json
{
  "cveID": "CVE-XXXX-XXXX",
  "vulnerabilityName": "Description of vulnerability",
  "dateAdded": "2024-01-01",
  "shortDescription": "Technical description",
  "requiredAction": "Patch immediately",
  "dueDate": "2024-01-22",
  "cwes": ["CWE-79"]
}
```

#### **3. Platform Data Feeds**
- **Sources**: All V2 platform feeds
- **Purpose**: Cross-reference CVE across all Apple platforms
- **Data**: Release versions, update names, exploitation status

### **CVE Details Page Sections**

Norte: Currently there ar minor glitches and spacing issues in the user interface. This will be addressed with improoving the detail CVE page preentation in a future update.

#### **1. Header Section**
- **CVE ID**: Large, prominent display
- **KEV Status**: Special badge for actively exploited CVEs
- **Severity Score**: CVSS score with color coding
- **Publication Dates**: First fix, last fix, modified dates

#### **2. Description Section**
- **Primary Description**: From Apple context database or platform feeds
- **Impact Assessment**: Detailed impact analysis
- **CWE Classification**: Links to MITRE CWE database
- **Tags**: Platform and vulnerability type tags

#### **3. Affected Systems**
- **Platform Coverage**: All affected Apple platforms
- **Version Information**: Specific OS versions with fixes
- **Update Names**: Security update identifiers
- **Release Timeline**: When fixes were released

#### **4. External Resources**
- **CVE.org**: Official CVE record
- **NVD (NIST)**: Detailed vulnerability analysis
- **CISA KEV**: If actively exploited
- **Apple Security**: Official Apple documentation

### **Data Processing Logic**

#### **CVE Data Aggregation**
1. **Context Lookup**: Search NDJSON file for CVE-specific context
2. **KEV Check**: Verify if CVE is in CISA's Known Exploited Vulnerabilities
3. **Platform Search**: Cross-reference across all V2 data feeds
4. **Data Merging**: Combine information from all sources

#### **Severity Calculation**
- **KEV CVEs**: Automatically marked as "Critical"
- **Context-based**: Uses Apple's security context
- **Default Scoring**: CVSS-based severity assessment

#### **Link Generation**
- **Apple URLs**: From context database security bulletins
- **External Links**: Dynamically generated for CVE.org, NVD, CISA
- **Internal Links**: Cross-references to platform pages \* 

*\* (this contextual link-back feature has some incosnistency atm, which can hopefully improved)*

## Technical Implementation

### **Search Algorithm**
```javascript
const searchInDataFeed = (dataFeed, regex, platform) => {
  // Search through OSVersions -> SecurityReleases -> CVEs
  // Match CVE IDs against regex pattern
  // Return results with platform context
}
```

### **CVE Details Loading**
```javascript
const loadCveDetails = async () => {
  // 1. Load NDJSON context data
  // 2. Search KEV catalog if applicable
  // 3. Cross-reference all platform feeds
  // 4. Merge and enrich data
}
```

### **Data Validation**
- **CVE ID Format**: Validates CVE-YYYY-NNNNN pattern
- **Input Sanitization**: Regex validation for search terms
- **Error Handling**: Graceful fallbacks for missing data

## User Experience Features

### **Search Experience**
- **Instant Results**: Real-time search as you type
- **Smart Filtering**: KEV prioritization option
- **Export Capability**: CSV download for results
- **External Integration**: Quick access to external databases

### **Details Experience**
- **Comprehensive Information**: All available data in one place
- **Visual Indicators**: Color-coded severity and KEV status
- **Cross-Platform View**: See CVE impact across all Apple platforms
- **External Resources**: One-click access to authoritative sources

### **Navigation Integration**
- **Search to Details**: Seamless transition from search results
- **Platform Cross-Reference**: Links to affected OS pages
- **Breadcrumb Navigation**: Clear path back to search

## Data Freshness & Updates

### **Update Frequency**
- **CVE Context**: Updated each 24 hours with a dedicated pipeline run
- **KEV Catalog**: Refreshed from CISA daily
- **Platform Data**: Real-time from V2 feeds

### **Data Sources**
- **Apple Security**: Official Apple security bulletins
- **CISA KEV**: Government known exploited vulnerabilities
- **NIST NVD**: National Vulnerability Database
- **VulnCheck Community API** - The folks at [VulnCheck](https://vulncheck.com/) have been super helpful in providing a community tier API access to their **NVD++** data, which is used in SOFA to complement the CVE details presented in the CVE details pages. This is beside Apple Security Pages and CISA our moste valuable source for CVE details. Thanks everyone at VulnCheck for providing their service!
- **Platform Feeds**: SOFA's processed security release data per OS/App

The CVE system provides comprehensive information usefull in vulnerability tracking and kicking off detailed analysis, making it simoler for security professionals and system administrators to dive into the process to understand and quickly respond to Apple platform vulnerabilities.

---
Last updated: 2025-09-08
